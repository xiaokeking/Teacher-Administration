define(["jquery","template","tool","ckeditor","uploadify","jquery_region","jquery_cookie"],function(e,i,t,a){e(function(){e.ajax({type:"get",url:"/api/teacher/profile",success:function(o){if(200==o.code){var s=i("settings_tpl",o.result);e(".teacher-profile").html(s),t.setDate("#tc_birthday"),t.setDate("#tc_join_date"),e("#upfile").uploadify({height:120,swf:"/public/assets/uploadify/uploadify.swf",uploader:"/api/uploader/avatar",fileObjName:"tc_avatar",width:120,buttonText:"",fileSizeLimit:"2MB",fileTypeExts:"*.gif; *.jpg; *.png",onUploadSuccess:function(i,t){var a=(t=JSON.parse(t)).result.path;e(".preview img").attr("src",a),e("#userinfo img").attr("src",a);var o=e.cookie("userinfo");(o=JSON.parse(o)).tc_avatar=a,e.cookie("userinfo",JSON.stringify(o),{path:"/",expires:1})}}),e("#region").region({url:"/public/assets/jquery-region/region.json"}),a.replace("tc_introduce",{toolbarGroups:[{name:"clipboard",groups:["clipboard","undo"]},{name:"basicstyles",groups:["basicstyles","cleanup"]},"/",{name:"paragraph",groups:["list","indent","blocks","align","bidi"]},{name:"styles"},{name:"colors"}]})}}}),e("body").on("click",".btn_save",function(){for(instance in a.instances)a.instances[instance].updateElement();e.ajax({type:"post",url:"/api/teacher/modify",data:e("form").serialize(),success:function(e){200==e.code&&(location.href="/settings")}})})})});